{
    "$ref": "https://www.cert.ssi.gouv.fr/openapi.json",
    "affected_systems": [],
    "affected_systems_content": "<p><span style=\"color: #ff0000;\"><strong>[Mise à jour du 27 février 2024] </strong></span></p> <p>L'ensemble des logiciels produits par la société AnyDesk (Windows, linux, MacOs, Android, iOS, AppleTV, On-Premises, etc.)</p> <ul> <li>Pour Windows les versions installables et portables qui ont été signées antérieurement aux versions 8.0.8 et <span style=\"color: #ff0000;\">7.0.15</span>;</li> <li><span style=\"color: #ff0000;\">Pour MacOS les versions installables qui ont été signées antérieurement aux versions 8.0.0 ;</span></li> <li><span style=\"color: #ff0000;\">Pour les versions Windows clients dites « custom » ou encore employées dans le cadre de la solution « On-premise », qui n’ont pas été régénérées en 7.0.14 depuis l’espace client AnyDesk ;</span></li> <li><span style=\"color: #ff0000;\">Pour les versions macOS clients dites « custom » ou encore employées dans le cadre de la solution « On-premise » qui n’ont pas été régénérées en 7.3.0 depuis l’espace client AnyDesk ;</span></li> <li>Pour les autres versions, l’ANSSI est dans l’attente de plus d’informations et vous invite à rester attentif aux futures communications.</li> </ul> ",
    "closed_at": "2024-04-15",
    "content": "",
    "cves": [],
    "links": [
        {
            "title": "Communiqué de l'éditeur AnyDesk du 2 février 2024",
            "url": "https://anydesk.com/en/public-statement"
        },
        {
            "title": "Les bons réflexes en cas d'intrusion",
            "url": "https://www.cert.ssi.gouv.fr/les-bons-reflexes-en-cas-dintrusion-sur-un-systeme-dinformation/"
        }
    ],
    "reference": "CERTFR-2024-ALE-003",
    "revisions": [
        {
            "description": "Version initiale",
            "revision_date": "2024-02-05T00:00:00.000000"
        },
        {
            "description": "Prise en compte des derniers communiqués de l'éditeur",
            "revision_date": "2024-02-27T00:00:00.000000"
        },
        {
            "description": "Clôture de l'alerte. Cela ne signifie pas la fin d'une menace. Seule l'application de la mise à jour permet de vous prémunir contre l'exploitation de la vulnérabilité correspondante.",
            "revision_date": "2024-04-15T00:00:00.000000"
        }
    ],
    "risks": [
        {
            "description": "Prise de contrôle à distance par un acteur malveillant"
        },
        {
            "description": "Atteinte à la confidentialité des données"
        }
    ],
    "summary": "<span style=\"color: #ff0000;\"><strong>\\[Mise à jour du 27 février 2024\\]</strong>\n</span>\n\nLe 29 janvier 2024 l'ANSSI a été alertée par le BSI que l'éditeur\nAnyDesk Software GmbH a été victime d'une fuite de données. Le code\nsource des applications développées par l'éditeur ainsi que des\ncertificats et clés privées pourraient avoir été dérobés. <span\nstyle=\"color: #ff0000;\">De plus, l’éditeur indique que deux de ses\nserveurs relais situés en Europe ont également été affectés par cet\nincident.</span>\n\nL'éditeur est spécialisé dans le développement de solutions logicielles\nde bureau à distance utilisables pour l'assistance à distance des\nutilisateurs, l'administration de serveurs, le télétravail ou encore le\nrebond vers des ressources internes d'entreprise non accessibles\npubliquement. Les solutions AnyDesk couvrent un large spectre de\nsystèmes d'exploitation : Linux, Windows, MacOS, Android, iOS, AppleTV,\netc.\n\nSelon l'entreprise, les données exfiltrées pourraient potentiellement\nêtre réutilisées dans le cadre d'attaques ultérieures visant les\nutilisateurs des solutions AnyDesk. Selon l'éditeur ces attaques sont\nsusceptibles de :\n\n-   Viser à affaiblir la sécurité de l'infrastructure de communication\n    entre utilisateurs AnyDesk, par exemple au travers d'attaques de\n    type homme du milieu/attaque de l'intercepteur (Meddler in the\n    Middle/Man in the Middle) ;\n-   Viser à altérer les logiciels publiés par l'entreprise ou identifiés\n    comme produits par l'entreprise.\n\nLe CERT-FR ne peut pas confirmer, à ce stade, la vraisemblance ou la\ncomplexité de mise en œuvre de telles attaques. Toutefois, au regard de\nla nature de ce type de solutions logicielles et de leurs conditions\nd'emploi, la compromission d'échanges entre utilisateurs ou le piégeage\napplicatif pourraient servir de point d'entrée vers les systèmes\nd'information.\n\n## Mesures conservatoires\n\n<span style=\"color: #ff0000;\"><strong>\\[Mise à jour du 27 février 2024\\]</strong>\n</span>\n\nEn attendant de disposer d'informations complémentaires, le CERT-FR\nrecommande de mettre en œuvre les actions suivantes:\n\n1.  Identifier et référencer sur vos systèmes d'information si l'une des\n    solutions AnyDesk est installée (ne pas oublier aussi de vérifier la\n    flotte mobile le cas échéant) :\n    -   Pour aider à identifier ces machines, plusieurs méthodes sont\n        proposées dans la section \"Identifier et référencer sur vos\n        systèmes d'informations l'emploi d'outils AnyDesk\",\n    -   Une fois cet inventaire réalisé, mettre sous séquestre les\n        résultats pour faciliter de potentielles futures\n        investigations ;\n2.  Identifier si l'installation de cette application a été faite dans\n    le cadre d'une activité légitime, connue et validée en interne de\n    votre entité ;\n3.  Identifier le niveau de sensibilité des machines, postes, serveurs\n    recourant à ces outils et les contraintes métier associées à leur\n    emploi ;\n4.  Dans le cadre de l'appréciation des risques, identifier l'impact que\n    pourrait avoir un scénario d'incident impliquant une potentielle\n    compromission d'une ou plusieurs de ces machines ;\n5.  En fonction de votre appréciation des risques, et afin d'anticiper\n    de potentielles futures levées de doutes, procéder et mettre sous\n    séquestre un relevé d'investigation numérique sur l'ensemble des\n    machines concernées :\n    -   Si cela ne peut être fait de façon globale, l'ANSSI recommande\n        de commencer par les machines les plus critiques,\n    -   Voir la section \"Collectes préventives\" ;\n6.  En fonction de votre appréciation des risques et des contraintes\n    métier:\n    -   <span style=\"color: #ff0000;\">Pour les solutions AnyDesk n’ayant\n        pas fait l’objet de mises à jour de sécurité, envisager la\n        désinstallation de la solution AnyDesk et l'utilisation d'une\n        solution alternative,</span>\n\n    -   <span style=\"color: #ff0000;\">Pour les environnements Windows et\n        macOS, de procéder à la mise à jour de la solution AnyDesk (la\n        mise à jour doit impérativement être téléchargée depuis le site\n        officiel de l'éditeur https://anydesk.com),</span>\n\n    -   Pour les autres versions, l’ANSSI est dans l’attente de plus\n        d’informations et vous invite à rester attentif aux futures\n        mises à jour publiées par l'éditeur,\n\n    -   Une fois le parc migré vers cette nouvelle version, et dans la\n        mesure du possible, de détecter/bloquer toute application signée\n        avec les certificats suivants:\n\n        -   Pour Windows\n\n        ```\n            fingerprint : 9cd1ddb78ed05282353b20cdfe8fa0a4fb6c1ece\n            serial : 0dbf152deaf0b981a8a938d53f769db8\n            Valide à partir du: lundi 13 décembre 2021 01:00:00\n            Valide jusqu'au: jeudi 9 janvier 2025 00:59:59\n            CN = philandro Software GmbH\n            O = philandro Software GmbH\n            L = Stuttgart\n            S = Baden-Württemberg\n            C = DE\n        ```\n\n        -   <span style=\"color: #ff0000;\">Pour macOS</span>\n\n        ```\n            fingerprint : 4a1dfb9aa37809b3a123e0ac750bf370469ebaeb\n            serial : 2379881731619607111 (0x210709d364a0d247)\n            Valide à partir du: mardi 8 juin 2021 11:04:30\n            Valide jusqu'au: mardi 9 juin 2026 11:04:29\n            CN = Developer ID Application: philandro Software GmbH (KU6W3B6JMZ)\n            OU = KU6W3B6JMZ\n            O = philandro Software GmbH\n            C = DE\n        ```\n7.  <span style=\"color: #ff0000;\">Procéder au renouvellement de\n    l’ensemble des mots de passe servant aux connexions aux instances\n    applicatives AnyDesk</span>\n8.  Rechercher toute activité suspecte sur et à l'origine de ces\n    machines à compter du 20/12/2023\n    -   En cas de doute, faire appel à un prestataire qualifié de\n        réponse aux incidents de sécurité (PRIS)\n\n## Identifier et référencer l'emploi d'outils Anydesk au sein du système d'information\n\nPour identifier quelles machines sont susceptibles de recourir à la\nsolution AnyDesk, il est possible de combiner plusieurs méthodes:\n\n### Au niveau réseau\n\nAu niveau réseau, identifier toute machine établissant des connexions\nvers:\n\n    *.net.anydesk.com\n\n### Au niveau système\n\nUn seul de ces observables peut indiquer la présence d'Anydesk\n\n#### Windows\n\nIl est possible de s'appuyer sur l'outil FastFind de l'ANSSI qui est\njoint à cette publication et de le passer sur les parcs Windows.\nCelui-ci reprend notamment les éléments ci-dessous qui peuvent également\nêtre recherchés via les éventuels outils existants au sein des SI (Par\nex. outils d'inventaires de parc, EDR, etc.).\n\n[<span\nstyle=\"display: block; text-align: center; padding: 5px 8px 5px 8px; background-color: #c4322c; width: 280px; height: 40px; margin: 0 auto; color: #ffffff;\"\ndarkreader-inline-bgcolor=\"\" darkreader-inline-color=\"\">Télécharger\nl'outil\nFastFind</span>](/uploads/20240205_AnyDesk-CERT-FR_TLP_CLEAR.zip)\n\nLa présence d'un des fichiers suivants:\n\n-   ```C:\\Program Files (x86)\\AnyDesk\\AnyDesk.exe```\n\n-   ```%PROGRAMDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp\\AnyDesk.lnk```\n\n-   ```C:\\Windows\\Prefetch\\ANYDESK.EXE-[A-F0-9]{8}.pf```\n\n(Pour rappel il existe également une version portable de l'application)\n\nIl est possible également de vérifier la présence des clés de registre\nsuivantes:\n\n-   ```HKLM\\SYSTEM\\ControlSet001\\Services\\AnyDesk```\n\n-   ```HKLM\\SOFTWARE\\Clients\\Media\\AnyDesk```\n\n-   ```HKLM\\SOFTWARE\\Classes\\.anydesk\\shell\\open\\command```\n\nDans les journaux Windows rechercher l'événement de création de service\n7045 ci-dessous:\n```\n    ImagePath:\"C:\\\\Program Files (x86)\\\\AnyDesk\\\\AnyDesk.exe\" –service\n    ServiceName:\"AnyDesk Service\"\n    ServiceType:\"service en mode utilisateur\",\n    StartType:\"Démarrage automatique\"\n```\nTous les logiciels signés avec le certificat\n```\n    fingerprint : 9cd1ddb78ed05282353b20cdfe8fa0a4fb6c1ece\n    serial : 0dbf152deaf0b981a8a938d53f769db8\n    lundi 13 décembre 2021 01:00:00\n    jeudi 9 janvier 2025 00:59:59\n    CN = philandro Software GmbH\n    O = philandro Software GmbH\n    L = Stuttgart\n    S = Baden-Württemberg\n    C = DE\n```\n##### \n\n#### Linux\n\nLa présence d'un des fichiers suivants :\n\n-   ```/etc/systemd/system/anydesk.service```\n\n-   ```/usr/bin/anydesk```\n\n-   ```/usr/lib64/anydesk```\n\n-   ```/usr/libexec/anydesk```\n\n-  ```/usr/bin/anydesk```\n\n-   ```/home/*/.anydesk/```\n\n##### \n\n#### MacOS\n\nLa présence d'un des fichiers suivants :\n\n-   ```~/.anydesk/system.conf```\n\n-   ```~/.anydesk/service.conf```\n\n-   ```~/.anydesk/user.conf```\n\nEt la présence de l'application\n\n    /Applications/Anydesk.app/\n\n##### \n\n#### \n\n## Collectes préventives\n\nUne fois l'inventaire réalisé et afin, dans la mesure du possible, de\nfaciliter de potentielles futures levées de doutes, l'ANSSI recommande\nde mettre sous séquestre a minima les éléments ci-dessous, avant de\nprocéder à la montée de version de l'application. Puis en cas de\nsuspicion de procéder à leur analyse.\n\n### Journaux à collecter\n\n-   journaux système des machines concernées ;\n-   journaux applicatifs des solutions AnyDesk ;\n    -   journaux spécifiques à l'application pour un environnement\n        Windows\n        -   ```%APPDATA%\\AnyDesk\\ad.trace # log interface utilisateur```\n\n        -   ```%PROGRAMDATA%\\AnyDesk\\ad_svc.trace # logs de service```\n\n        -   ```%PROGRAMDATA%\\AnyDesk\\connection_trace.txt # logs des connexions entrantes```\n    -   journaux spécifiques à l'application pour un environnement Linux\n        -  ```/home/*/.anydesk/.anydesk.trace```\n\n        -   ```/home/*/.anydesk/anydesk.trace```\n\n        -  ``` /root/*/.anydesk/.anydesk.trace```\n\n        -  ``` /root/*/.anydesk/anydesk.trace```\n\n        -   ```/var/log/anydesk.trace```\n\n        -   ```/etc/anydesk/connection_trace.txt```\n    -   journaux spécifiques à l'application pour un environnement MacOS\n        -   ```~/.anydesk/anydesk.trace```\n\n        -   ```~/.anydesk/connection_trace.txt```\n-   journaux réseau en lien avec les machines concernées.\n\n \n",
    "title": "[MàJ] Incident affectant les solutions AnyDesk",
    "vendor_advisories": []
}